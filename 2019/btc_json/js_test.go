package js

import (
	"encoding/json"
	"fmt"
	"github.com/shopspring/decimal"
	"testing"
)

const tx1 = `{"txid":"a404ab8b80d3fb3f883ef8ef26c635c8c6f9051918405fd4125d2b28fd48f0ca","hash":"a404ab8b80d3fb3f883ef8ef26c635c8c6f9051918405fd4125d2b28fd48f0ca","version":1,"size":1715,"vsize":1715,"weight":6860,"locktime":0,"hex":"010000000ed463d1902dcc62f3ff3d00300f71e4eb7e0b89868fcc41e432be36eeaa3a4a85000000004a493046022100b7620ac2290d87f0a1507000f31f04855ea33a3b1dbfbe0fd945472e6a1f1a26022100baf25292bc5eb997efc4193c0846e1e1750f7978475ae8045b38d968f715157e01ffffffff03b73a4ed95cdd43912d4c84fdd1f0667814c5b67c26f81350160551e32c07b2000000004948304502206d94ea428844bfcb4005364aa0ccd35edcd9abfa75016a3f90c4544722217071022100ac888720c214bad112872d4558159dadf65815524c91cceb3209b442b3c6bd8301ffffffff10214e34b48df9871fa2e8d52833f22bca1f8a81be78dd49ef295a94fce0da79000000004847304402200cdd112bc208cf0c91ef8af3018f9a9df1cf6beaced1c90feb441cbbac460a140220013ab8ca3841d4671e8b13297167f5ca88ced359f5f702a5258252dc63150f6f01ffffffff684647a49ba938b652e4bb066533effe7d6674337d518ff137ff5b9befada19a000000004847304402202d8dae2f2c6a1fe33d709bae5fdf4feaa62a7f174ca7704816fa8b121dbcb6f8022065a26bcb304392b291b42cda06324033dfbd5a97adae28978e176ba3a299159301ffffffff2f8c49f6508de54eb061ba9ed68bda93ef48059949dc1b51420e90ab499781a9000000004847304402200b633de750f3955d3028a3f86bb3036716fe1bc0d44938c45944f641af0e0746022030a86f9ca25dca53e3f606320c36e26c096b067584865f3db5f9694c80950b5501ffffffff23e19e4e9694801d08a7e81135c094f1577f50d8ea1c89b4db1f389f0f6ff397000000004a493046022100bfd5ed9c7440dcbbf593c515893e6f6670d58b4c524b13ad698500894609d23f022100cb4dc39a888545ad6f249c04377d9ac36f9f67b1cc9e9a0adef0c6718d3339ee01ffffffffdf842bf3ff367b260a67525c2eda79d1125a9f0e675675c152f007778b1b0db2000000004a49304602210088ab256e414da04cabdb13dc6644aa838ef8a63b900afe744faef053a5d1027b022100a05e0618a965c5c1ae8f4b48a9ac90c56867ba281d3db4ff0c836332d6d5a66801ffffffff71344e6fc98a5d4b77cef1bc7560a704797df8a84cc5c58dad085140aa8ee1510000000049483045022100f3cd3dbea76185abfe86264c69082b65988015e2c3c1a9c1c66eac9f406eec6b02206c5c1bd0b2112fece50878f74aa596a9a87c00fe302609387944c3804b42268101ffffffffd0148037824d064ae6a8a14f5c6c1def5e5fa5931cf959ee4fef6efd767297ee0000000048473044022050f0a9978ea0dc40b8c922d93b70866315ba708678a229004565bb0d8fb19a2a02205dc6d8533dda3c93a8a9df1ec008cfd3eea5de476037e079eb0cd0f4fcf5ae7a01ffffffffe7f34d867579773d0e9e34abf926226bc6ec8c901c9c1df9ae49ebea91b7874c000000004948304502201f9028b4722509d4094fa8b087797a8c97bb16cdbfc994f81d50ca5324aff9d202210088e4a59373a0267f16a39f0e77f0a08adb86caebb00d7d2754aafabe2e77998901ffffffffb89bf506ad72887a275e2204b5eaf69b7e1b9d1dee6ae358d2e6c3cc590b4ddf0000000049483045022100fda6bde860ad61d28d870fdeb855fc05af551c3f742b86287318245446ee49e702201a0061d4af917d95050a9aa8de80c3c281316ac6edae41c7b27aa096c904f3a301ffffffff68956cfddb86d336787714693c0d9d6f07207a82201bececfabdc923f94359ac0000000049483045022100a7f44fd82bdee6dfe99a1cd224135ea4fa4ee691fd608563455144d94d8e2f3b022029fdf4bc38e16936e945424c35dfe40f90c56d309e401aa8b54a8c25fc452bdd01ffffffffd4a98fea8764d59d8b48b9ecdc43c59443e19836d738fb1a502458f6836010fe000000004a493046022100e863b6bd0822161c38e976de9b7db193745f0cf8cf62c939202328a21200a661022100d25ed53402669be070b182571e87e552ea88f5d3637806fd44222de7c032182501ffffffff4dba413d76a8dacdd03ec462f975944d1591eade2658db781b824c281aa7398900000000484730440220376fce77c4d2a58647330552013c30f8c66adeaa0b106d765b12f903e47409a402206735b4c10eb7d999bf03bdb41fad79230a1ef676ad68d13ddf9b91600816025f01ffffffff0240cc9e310f0000001976a9148504a793ef6d5b60db71927bcf8c6718a500844d88ac8008ff5400000000434104646ab2de8cd139e32558e325606fbe286971f49d581331b44e4690ba025a9f90f53d44f6e638bf6338360d43695ee856806602d60dc41f091a0a1c1b116228b4ac00000000","vin":[{"txid":"854a3aaaee36be32e441cc8f86890b7eebe4710f30003dfff362cc2d90d163d4","vout":0,"scriptSig":{"asm":"3046022100b7620ac2290d87f0a1507000f31f04855ea33a3b1dbfbe0fd945472e6a1f1a26022100baf25292bc5eb997efc4193c0846e1e1750f7978475ae8045b38d968f715157e[ALL]","hex":"493046022100b7620ac2290d87f0a1507000f31f04855ea33a3b1dbfbe0fd945472e6a1f1a26022100baf25292bc5eb997efc4193c0846e1e1750f7978475ae8045b38d968f715157e01"},"sequence":4294967295,"refer":{"value":16.83,"n":0,"scriptPubKey":{"asm":"047a4bb59f6f17b823ac377b11eb4361c6b213574609d576bdf2aab2add4b5de06e56654441e8420f09866105a7761e727ea0ac6c6b8685c608415cccb2ac3e284 OP_CHECKSIG","hex":"41047a4bb59f6f17b823ac377b11eb4361c6b213574609d576bdf2aab2add4b5de06e56654441e8420f09866105a7761e727ea0ac6c6b8685c608415cccb2ac3e284ac","reqSigs":1,"type":"pubkey","addresses":["1DNNSfKSxG7P7TvcAHvJDCqgrFXZTACiCm"]}}},{"txid":"b2072ce35105165013f8267cb6c5147866f0d1fd844c2d9143dd5cd94e3ab703","vout":0,"scriptSig":{"asm":"304502206d94ea428844bfcb4005364aa0ccd35edcd9abfa75016a3f90c4544722217071022100ac888720c214bad112872d4558159dadf65815524c91cceb3209b442b3c6bd83[ALL]","hex":"48304502206d94ea428844bfcb4005364aa0ccd35edcd9abfa75016a3f90c4544722217071022100ac888720c214bad112872d4558159dadf65815524c91cceb3209b442b3c6bd8301"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"0432c6b63473a4d0c95f6c304bf0388b7d66c843723d941581d68ebe8d34509386bfeaa300ed018d5a52b480bfc7e375f3288f6e01a60b0562eedf0e1a94ceb4b3 OP_CHECKSIG","hex":"410432c6b63473a4d0c95f6c304bf0388b7d66c843723d941581d68ebe8d34509386bfeaa300ed018d5a52b480bfc7e375f3288f6e01a60b0562eedf0e1a94ceb4b3ac","reqSigs":1,"type":"pubkey","addresses":["16eUYfN4eHgSCqV3LHyEuKDJZdovhNW7fw"]}}},{"txid":"79dae0fc945a29ef49dd78be818a1fca2bf23328d5e8a21f87f98db4344e2110","vout":0,"scriptSig":{"asm":"304402200cdd112bc208cf0c91ef8af3018f9a9df1cf6beaced1c90feb441cbbac460a140220013ab8ca3841d4671e8b13297167f5ca88ced359f5f702a5258252dc63150f6f[ALL]","hex":"47304402200cdd112bc208cf0c91ef8af3018f9a9df1cf6beaced1c90feb441cbbac460a140220013ab8ca3841d4671e8b13297167f5ca88ced359f5f702a5258252dc63150f6f01"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"04352fa7fe16341679512ff56dc0407938cf8b75ca47374b16e8fc177b4156ee9e43dfc9f7663b25e95476f80e737e288497086d4c708684ff2ddfb33e8607bd7a OP_CHECKSIG","hex":"4104352fa7fe16341679512ff56dc0407938cf8b75ca47374b16e8fc177b4156ee9e43dfc9f7663b25e95476f80e737e288497086d4c708684ff2ddfb33e8607bd7aac","reqSigs":1,"type":"pubkey","addresses":["1Mgg6Z9hkGDxL9ynmHE41Zc1of4Zepx5CW"]}}},{"txid":"9aa1adef9b5bff37f18f517d3374667dfeef336506bbe452b638a99ba4474668","vout":0,"scriptSig":{"asm":"304402202d8dae2f2c6a1fe33d709bae5fdf4feaa62a7f174ca7704816fa8b121dbcb6f8022065a26bcb304392b291b42cda06324033dfbd5a97adae28978e176ba3a2991593[ALL]","hex":"47304402202d8dae2f2c6a1fe33d709bae5fdf4feaa62a7f174ca7704816fa8b121dbcb6f8022065a26bcb304392b291b42cda06324033dfbd5a97adae28978e176ba3a299159301"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"0436d517ec06ce742cca781f737b970946ca1c73f451bdaba4fc59566b536693f428504f97a37dd6396d9d0a9703d0b31dfe93657ee5e1a1784d5425861efec733 OP_CHECKSIG","hex":"410436d517ec06ce742cca781f737b970946ca1c73f451bdaba4fc59566b536693f428504f97a37dd6396d9d0a9703d0b31dfe93657ee5e1a1784d5425861efec733ac","reqSigs":1,"type":"pubkey","addresses":["1EpnNHAcLKHjKSJYrbuwWkDABa2xBN2Fyw"]}}},{"txid":"a9819749ab900e42511bdc49990548ef93da8bd69eba61b04ee58d50f6498c2f","vout":0,"scriptSig":{"asm":"304402200b633de750f3955d3028a3f86bb3036716fe1bc0d44938c45944f641af0e0746022030a86f9ca25dca53e3f606320c36e26c096b067584865f3db5f9694c80950b55[ALL]","hex":"47304402200b633de750f3955d3028a3f86bb3036716fe1bc0d44938c45944f641af0e0746022030a86f9ca25dca53e3f606320c36e26c096b067584865f3db5f9694c80950b5501"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"04325b66b6ed169460cf026100d2fa0e7b94c09711e4bd6ea3c41409da6387a2a1d545799a7deca6e86d6791dc9e9be19b0aaf8481f128dfcefd4926f2eb18ca81 OP_CHECKSIG","hex":"4104325b66b6ed169460cf026100d2fa0e7b94c09711e4bd6ea3c41409da6387a2a1d545799a7deca6e86d6791dc9e9be19b0aaf8481f128dfcefd4926f2eb18ca81ac","reqSigs":1,"type":"pubkey","addresses":["12FWEZqUeFftXZph6TT1xdejL9fsYSumQt"]}}},{"txid":"97f36f0f9f381fdbb4891cead8507f57f194c03511e8a7081d8094964e9ee123","vout":0,"scriptSig":{"asm":"3046022100bfd5ed9c7440dcbbf593c515893e6f6670d58b4c524b13ad698500894609d23f022100cb4dc39a888545ad6f249c04377d9ac36f9f67b1cc9e9a0adef0c6718d3339ee[ALL]","hex":"493046022100bfd5ed9c7440dcbbf593c515893e6f6670d58b4c524b13ad698500894609d23f022100cb4dc39a888545ad6f249c04377d9ac36f9f67b1cc9e9a0adef0c6718d3339ee01"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"046258fdd595672dfc6738d251582f686fcb2a31e5d819d1cf8145e370dc4dfa3927b4afe4b419f4d2117d51bba9a137e68bfc187067a15f3d966eb8fa8dc2f93b OP_CHECKSIG","hex":"41046258fdd595672dfc6738d251582f686fcb2a31e5d819d1cf8145e370dc4dfa3927b4afe4b419f4d2117d51bba9a137e68bfc187067a15f3d966eb8fa8dc2f93bac","reqSigs":1,"type":"pubkey","addresses":["1EdVNp3ZodwLLkJ9QPWqi2BGQW65918MUH"]}}},{"txid":"b20d1b8b7707f052c17556670e9f5a12d179da2e5c52670a267b36fff32b84df","vout":0,"scriptSig":{"asm":"304602210088ab256e414da04cabdb13dc6644aa838ef8a63b900afe744faef053a5d1027b022100a05e0618a965c5c1ae8f4b48a9ac90c56867ba281d3db4ff0c836332d6d5a668[ALL]","hex":"49304602210088ab256e414da04cabdb13dc6644aa838ef8a63b900afe744faef053a5d1027b022100a05e0618a965c5c1ae8f4b48a9ac90c56867ba281d3db4ff0c836332d6d5a66801"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"048e2c4883274079ed1bf0dc3576166efbb67afbb5351e657e81b20e8874e8b259f34a0a935ce9279e33e1c6cae5cdd5891b27fd091d3b1f1f2e40bc4d65476f27 OP_CHECKSIG","hex":"41048e2c4883274079ed1bf0dc3576166efbb67afbb5351e657e81b20e8874e8b259f34a0a935ce9279e33e1c6cae5cdd5891b27fd091d3b1f1f2e40bc4d65476f27ac","reqSigs":1,"type":"pubkey","addresses":["14zc2QzfckFnrgJR4wg7RgvWh4dAqLXJuo"]}}},{"txid":"51e18eaa405108ad8dc5c54ca8f87d7904a76075bcf1ce774b5d8ac96f4e3471","vout":0,"scriptSig":{"asm":"3045022100f3cd3dbea76185abfe86264c69082b65988015e2c3c1a9c1c66eac9f406eec6b02206c5c1bd0b2112fece50878f74aa596a9a87c00fe302609387944c3804b422681[ALL]","hex":"483045022100f3cd3dbea76185abfe86264c69082b65988015e2c3c1a9c1c66eac9f406eec6b02206c5c1bd0b2112fece50878f74aa596a9a87c00fe302609387944c3804b42268101"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"040e8bb4db6c6067f7982816efe3e9ee705c8bddeeba635751d59e8a1441610964fe3b937cd7a827492ed8f1b4f968d103aa31c0391da5f8a4da0e5dfbfeb88b8a OP_CHECKSIG","hex":"41040e8bb4db6c6067f7982816efe3e9ee705c8bddeeba635751d59e8a1441610964fe3b937cd7a827492ed8f1b4f968d103aa31c0391da5f8a4da0e5dfbfeb88b8aac","reqSigs":1,"type":"pubkey","addresses":["1AigmaXv6DF8svurNrnsRTB3RWfnjRA1JA"]}}},{"txid":"ee977276fd6eef4fee59f91c93a55f5eef1d6c5c4fa1a8e64a064d82378014d0","vout":0,"scriptSig":{"asm":"3044022050f0a9978ea0dc40b8c922d93b70866315ba708678a229004565bb0d8fb19a2a02205dc6d8533dda3c93a8a9df1ec008cfd3eea5de476037e079eb0cd0f4fcf5ae7a[ALL]","hex":"473044022050f0a9978ea0dc40b8c922d93b70866315ba708678a229004565bb0d8fb19a2a02205dc6d8533dda3c93a8a9df1ec008cfd3eea5de476037e079eb0cd0f4fcf5ae7a01"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"042e1a2398dc71425b880f4b46acae2b47591c68113405a9635b607280fe80b249d24665a172cd69e49d29762f07f2da650fe5e0d511ced0bdd882c088ae8ecf40 OP_CHECKSIG","hex":"41042e1a2398dc71425b880f4b46acae2b47591c68113405a9635b607280fe80b249d24665a172cd69e49d29762f07f2da650fe5e0d511ced0bdd882c088ae8ecf40ac","reqSigs":1,"type":"pubkey","addresses":["1NyP4ZEM1vsMfnTSkmnMow51BMGDgofqRC"]}}},{"txid":"4c87b791eaeb49aef91d9c1c908cecc66b2226f9ab349e0e3d777975864df3e7","vout":0,"scriptSig":{"asm":"304502201f9028b4722509d4094fa8b087797a8c97bb16cdbfc994f81d50ca5324aff9d202210088e4a59373a0267f16a39f0e77f0a08adb86caebb00d7d2754aafabe2e779989[ALL]","hex":"48304502201f9028b4722509d4094fa8b087797a8c97bb16cdbfc994f81d50ca5324aff9d202210088e4a59373a0267f16a39f0e77f0a08adb86caebb00d7d2754aafabe2e77998901"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"0463da15098250b8dbd45dc09d73d3fe5cb0e0f71fa2f772500fa065d30a04b3558d43e1d8bb9a4cc123d6a94e36e36d1ba713a69597e161a97593ba5625535a0b OP_CHECKSIG","hex":"410463da15098250b8dbd45dc09d73d3fe5cb0e0f71fa2f772500fa065d30a04b3558d43e1d8bb9a4cc123d6a94e36e36d1ba713a69597e161a97593ba5625535a0bac","reqSigs":1,"type":"pubkey","addresses":["1GQLkNKAihsRb1DNGUQpApAb2myuzMhvXX"]}}},{"txid":"df4d0b59ccc3e6d258e36aee1d9d1b7e9bf6eab504225e277a8872ad06f59bb8","vout":0,"scriptSig":{"asm":"3045022100fda6bde860ad61d28d870fdeb855fc05af551c3f742b86287318245446ee49e702201a0061d4af917d95050a9aa8de80c3c281316ac6edae41c7b27aa096c904f3a3[ALL]","hex":"483045022100fda6bde860ad61d28d870fdeb855fc05af551c3f742b86287318245446ee49e702201a0061d4af917d95050a9aa8de80c3c281316ac6edae41c7b27aa096c904f3a301"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"040a5f09b84bf23d9d0c4ce12387a13f0d76aa8e8fd33b0335e324fea1542b6d355fb03a6263b102589802374d3962942e0ca1812252fdb475d37a4eaf52902376 OP_CHECKSIG","hex":"41040a5f09b84bf23d9d0c4ce12387a13f0d76aa8e8fd33b0335e324fea1542b6d355fb03a6263b102589802374d3962942e0ca1812252fdb475d37a4eaf52902376ac","reqSigs":1,"type":"pubkey","addresses":["17mzh6AakzyVb4Kd8bUQfiJBe9DhRzgHuU"]}}},{"txid":"ac5943f923c9bdfaecec1b20827a20076f9d0d3c6914777836d386dbfd6c9568","vout":0,"scriptSig":{"asm":"3045022100a7f44fd82bdee6dfe99a1cd224135ea4fa4ee691fd608563455144d94d8e2f3b022029fdf4bc38e16936e945424c35dfe40f90c56d309e401aa8b54a8c25fc452bdd[ALL]","hex":"483045022100a7f44fd82bdee6dfe99a1cd224135ea4fa4ee691fd608563455144d94d8e2f3b022029fdf4bc38e16936e945424c35dfe40f90c56d309e401aa8b54a8c25fc452bdd01"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"0468966d8d7a7e3dad1aada26870151778926369fdd17205402821d10b149f147bd01df05104c2c04b0a4b81fee89b44b09f71372a9a244ab2e8db321cbe7ca3f3 OP_CHECKSIG","hex":"410468966d8d7a7e3dad1aada26870151778926369fdd17205402821d10b149f147bd01df05104c2c04b0a4b81fee89b44b09f71372a9a244ab2e8db321cbe7ca3f3ac","reqSigs":1,"type":"pubkey","addresses":["1LdWqT5vynXbEYZ1cj2tf3oCqvvss2mFX"]}}},{"txid":"fe106083f65824501afb38d73698e14394c543dcecb9488b9dd56487ea8fa9d4","vout":0,"scriptSig":{"asm":"3046022100e863b6bd0822161c38e976de9b7db193745f0cf8cf62c939202328a21200a661022100d25ed53402669be070b182571e87e552ea88f5d3637806fd44222de7c0321825[ALL]","hex":"493046022100e863b6bd0822161c38e976de9b7db193745f0cf8cf62c939202328a21200a661022100d25ed53402669be070b182571e87e552ea88f5d3637806fd44222de7c032182501"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"0489b27788bffa91fe254166bb0ccb16359e840988f3dee2e7d15fc95add262025ce66b50fc187bc52caeaf7dbbb328f82c49ea0264e4efe6f74843afb8a408bc6 OP_CHECKSIG","hex":"410489b27788bffa91fe254166bb0ccb16359e840988f3dee2e7d15fc95add262025ce66b50fc187bc52caeaf7dbbb328f82c49ea0264e4efe6f74843afb8a408bc6ac","reqSigs":1,"type":"pubkey","addresses":["1CnuTpcTaFkAGkDdijEMGKBQK3M2Bh3TNE"]}}},{"txid":"8939a71a284c821b78db5826deea91154d9475f962c43ed0cddaa8763d41ba4d","vout":0,"scriptSig":{"asm":"30440220376fce77c4d2a58647330552013c30f8c66adeaa0b106d765b12f903e47409a402206735b4c10eb7d999bf03bdb41fad79230a1ef676ad68d13ddf9b91600816025f[ALL]","hex":"4730440220376fce77c4d2a58647330552013c30f8c66adeaa0b106d765b12f903e47409a402206735b4c10eb7d999bf03bdb41fad79230a1ef676ad68d13ddf9b91600816025f01"},"sequence":4294967295,"refer":{"value":50,"n":0,"scriptPubKey":{"asm":"043e32abd0baf353598aef4de696c40a2f40a29166a1334457c3604bfdd57298c51eb368f67e238044d1aba996c36c62181724dabe6195f6d315231868d16a18eb OP_CHECKSIG","hex":"41043e32abd0baf353598aef4de696c40a2f40a29166a1334457c3604bfdd57298c51eb368f67e238044d1aba996c36c62181724dabe6195f6d315231868d16a18ebac","reqSigs":1,"type":"pubkey","addresses":["1AwoxcyjXpA43WNPqbLZsjh2KnNoWVrE3S"]}}}],"vout":[{"value":652.57,"n":0,"scriptPubKey":{"asm":"OP_DUP OP_HASH160 8504a793ef6d5b60db71927bcf8c6718a500844d OP_EQUALVERIFY OP_CHECKSIG","hex":"76a9148504a793ef6d5b60db71927bcf8c6718a500844d88ac","reqSigs":1,"type":"pubkeyhash","addresses":["1D8LSvQZcr1xHhYm6MnX2idmh7hLZVCHpC"]}},{"value":14.26,"n":1,"scriptPubKey":{"asm":"04646ab2de8cd139e32558e325606fbe286971f49d581331b44e4690ba025a9f90f53d44f6e638bf6338360d43695ee856806602d60dc41f091a0a1c1b116228b4 OP_CHECKSIG","hex":"4104646ab2de8cd139e32558e325606fbe286971f49d581331b44e4690ba025a9f90f53d44f6e638bf6338360d43695ee856806602d60dc41f091a0a1c1b116228b4ac","reqSigs":1,"type":"pubkey","addresses":["1N8hXTodEaEsGR68uSY157CxSTk1VGfkHd"]}}],"height":41654,"fee":0,"blockhash":"000000004abcace3830e591281025a0ba4fbf27842ca5de934be5aefa579ae6f","blocktime":0,"time":0,"confirmations":0}`

func TestJson(t *testing.T) {
	tx := Transaction{}
	if err := json.Unmarshal([]byte(tx1), &tx); err != nil {
		panic(err)
	}
	var coinBase bool
	var vIn, vOut decimal.Decimal //计算交易手续费用
	for index, in := range tx.VIn {
		if in.TxID == "" {
			vIn = decimal.NewFromFloat(Reward(tx.BlockHeight))
			coinBase = true
			continue //skip coin base
		}
		vIn = vIn.Add(decimal.NewFromFloat(tx.VIn[index].Refer.Value))
		fmt.Println("in:", tx.VIn[index].Refer.Value, vIn)
	}
	for _, out := range tx.VOut {
		vOut = vOut.Add(decimal.NewFromFloat(out.Value))
		fmt.Println("out:", out.Value, vOut)
	}
	if coinBase {
		fee, ex := vOut.Sub(vIn).Mul(decimal.New(Decimals, 0)).Float64()
		if !ex {
			t.Fatal("ex")
		}
		tx.Fee = uint64(fee)
	} else {
		fee, ex := vIn.Sub(vOut).Mul(decimal.New(Decimals, 0)).Float64()
		if !ex {
			t.Fatal("ex")
		}
		tx.Fee = uint64(fee)
	}
	fmt.Println("fee:", vIn, vOut, tx.Fee)
	d, err := json.Marshal(tx)
	if err != nil {
		panic(err)
	}
	fmt.Println(string(d))
}

func TestFloat(t *testing.T) {
	in1,in2,in3,in4,in5 := 16.83,50.0,50.0,50.0,50.0
	value := decimal.NewFromFloat(0.0)

	value = value.Add(decimal.NewFromFloat(in1))
	fmt.Println(value.Float64())

	value = value.Add(decimal.NewFromFloat(in2))
	fmt.Println(value.Float64())

	value = value.Add(decimal.NewFromFloat(in3))
	fmt.Println(value.Float64())

	value = value.Add(decimal.NewFromFloat(in4))
	fmt.Println(value.Float64())

	value = value.Add(decimal.NewFromFloat(in5))
	fmt.Println(value.Mul(decimal.New(Decimals, 0)).Float64())
}